---
- name: Link user home files
  file:
    src: "{{ item.value.src }}"
    dest: "{{ item.value.dest }}"
    state: link
  with_dict: "{{user_desktop_files}}"
  vars:
    user_desktop_files:
      xinitrc:
        src: "{{playbook_dir}}/configs/desktop/home/.xinitrc"
        dest: "{{ lookup('env', 'HOME') }}/.xinitrc"

- name: Copy /usr/local/etc files
  become: true
  become_method: su
  copy:
    src: "{{ item.value.src }}"
    dest: "{{ item.value.dest }}"
    owner: root
    group: wheel
    mode: u=rw,g=r,o=r
  with_dict: "{{user_local_files}}"
  vars:
    user_local_files:
      xorg.conf.d:
        src: "{{playbook_dir}}/configs/desktop/usr/local/etc/X11/xorg.conf.d/50-mouse.conf"
        dest: "/usr/local/etc/X11/xorg.conf.d/50-mouse.conf"
      doas:
        src: "{{playbook_dir}}/configs/desktop/usr/local/etc/doas.conf"
        dest: "/usr/local/etc/doas.conf"

- name: Copy system configuration files
  become: true
  become_method: su
  copy:
    src: "{{ item.value.src }}"
    dest: "{{ item.value.dest }}"
    owner: root
    group: wheel
    mode: u=rw,g=r,o=r
  with_dict: "{{system_desktop_files}}"
  vars:
    system_desktop_files:
      etc-rc:
        src: "{{playbook_dir}}/configs/desktop/etc/rc.conf"
        dest: "/etc/rc.conf"

      etc-devfs:
        src: "{{playbook_dir}}/configs/desktop/etc/devfs.rules"
        dest: "/etc/devfs.rules"

      boot-loader:
        src: "{{playbook_dir}}/configs/desktop/boot/loader.conf"
        dest: "/boot/loader.conf"

